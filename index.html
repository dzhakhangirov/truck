<!DOCTYPE html><html lang="ru"><head><meta charset="UTF-8"><meta name="viewport"content="width=device-width, initial-scale=1.0"><title>3D Truck Parts Controller</title><style>.babylonLogo,.watermark,[class*="babylon"],[class*="logo"],[id*="watermark"],[id*="logo"],canvas[style*="position: absolute"],canvas[style*="z-index: 999"],div[style*="position: absolute"]{display:none!important;visibility:hidden!important;opacity:0!important;pointer-events:none!important;}
body{font-family:Arial,sans-serif;margin:0;padding:20px;background-color:#f0f0f0;overflow:hidden;}.container{display:flex;height:100vh;gap:20px;}.model-container{flex:3;position:relative;}#renderCanvas{width:100%;height:100%;border-radius:8px;box-shadow:0 4px 6px rgba(0,0,0,0.1);display:block;outline:none!important;border:none!important;user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;}.controls{flex:1;max-width:25%;background-color:white;padding:20px;border-radius:8px;box-shadow:0 4px 6px rgba(0,0,0,0.1);overflow-y:auto;}.switch-container{margin-bottom:20px;padding:10px;border:1px solid#e0e0e0;border-radius:6px;background-color:#fafafa;}.switch-container label{display:flex;align-items:center;justify-content:space-between;cursor:pointer;}.switch-text{flex:1;}.part-name{font-size:11px;color:#888;margin-top:3px;}.switch{position:relative;display:inline-block;width:50px;height:24px;}.switch input{opacity:0;width:0;height:0;}.slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#ccc;transition:.4s;border-radius:24px;}.slider:before{position:absolute;content:"";height:18px;width:18px;left:3px;bottom:3px;background-color:white;transition:.4s;border-radius:50%;}
input:checked+.slider{background-color:#4285f4;}
input:checked+.slider:before{transform:translateX(26px);}
h1{color:#333;text-align:center;margin-bottom:20px;font-size:18px;}.status{font-size:12px;color:#666;margin-top:5px;font-style:italic;}.loading{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#333;font-size:16px;background-color:rgba(255,255,255,0.8);padding:10px 20px;border-radius:8px;z-index:1000;}@media(max-width:768px){.container{flex-direction:column;height:auto;}.model-container{height:400px;}.controls{max-width:100%;}}</style></head><body><div class="container"><div class="model-container"><canvas id="renderCanvas"></canvas><div class="loading"id="loading">Загрузка модели...</div></div><div class="controls"><h1>Управление деталями грузовика</h1><div class="switch-container"><label><div class="switch-text"><div>Деталь 1</div><div class="part-name">Part_1</div></div><div class="switch"><input type="checkbox"id="switch1"><span class="slider"></span></div></label><div class="status"id="status1">Выкл</div></div><div class="switch-container"><label><div class="switch-text"><div>Деталь 2</div><div class="part-name">Part_2</div></div><div class="switch"><input type="checkbox"id="switch2"><span class="slider"></span></div></label><div class="status"id="status2">Выкл</div></div><div class="switch-container"><label><div class="switch-text"><div>Деталь 3</div><div class="part-name">Part_3</div></div><div class="switch"><input type="checkbox"id="switch3"><span class="slider"></span></div></label><div class="status"id="status3">Выкл</div></div><div class="switch-container"><label><div class="switch-text"><div>Деталь 4</div><div class="part-name">Part_4</div></div><div class="switch"><input type="checkbox"id="switch4"><span class="slider"></span></div></label><div class="status"id="status4">Выкл</div></div><div class="switch-container"><label><div class="switch-text"><div>Деталь 5</div><div class="part-name">Part_5</div></div><div class="switch"><input type="checkbox"id="switch5"><span class="slider"></span></div></label><div class="status"id="status5">Выкл</div></div><div class="switch-container"><label><div class="switch-text"><div>Деталь 6</div><div class="part-name">Part_6</div></div><div class="switch"><input type="checkbox"id="switch6"><span class="slider"></span></div></label><div class="status"id="status6">Выкл</div></div><div class="switch-container"><label><div class="switch-text"><div>Деталь 7</div><div class="part-name">Truck_01_primitive0</div></div><div class="switch"><input type="checkbox"id="switch7"><span class="slider"></span></div></label><div class="status"id="status7">Выкл</div></div></div></div><!--Babylon.js--><script src="https://cdn.babylonjs.com/babylon.js"></script><script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.min.js"></script><script>const originalCreateElement=document.createElement;document.createElement=function(tagName){const element=originalCreateElement.call(this,tagName);if(tagName.toLowerCase()==='canvas'){setTimeout(()=>{const logos=document.querySelectorAll('.babylonLogo, .watermark');logos.forEach(logo=>{logo.style.display='none';logo.remove();});},0);}
return element;};document.addEventListener('DOMContentLoaded',async()=>{const canvas=document.getElementById('renderCanvas');const loading=document.getElementById('loading');const meshNames=['Part_1','Part_2','Part_3','Part_4','Part_5','Part_6','Truck_01_primitive0'];const switches=[document.getElementById('switch1'),document.getElementById('switch2'),document.getElementById('switch3'),document.getElementById('switch4'),document.getElementById('switch5'),document.getElementById('switch6'),document.getElementById('switch7')];const statuses=[document.getElementById('status1'),document.getElementById('status2'),document.getElementById('status3'),document.getElementById('status4'),document.getElementById('status5'),document.getElementById('status6'),document.getElementById('status7')];const meshesMap=new Map();let transparencyMaterial=null;let engine=null;let scene=null;engine=new BABYLON.Engine(canvas,true,{preserveDrawingBuffer:true,stencil:true});scene=new BABYLON.Scene(engine);scene.clearColor=new BABYLON.Color3(1,1,1);if(scene.debugLayer){scene.debugLayer.hide();}
const camera=new BABYLON.ArcRotateCamera("camera",-2.317,1.175,7,new BABYLON.Vector3(0,0.0,0.255444),scene);camera.attachControl(canvas,true);camera.lowerRadiusLimit=5;camera.upperRadiusLimit=10;document.onclick=function(){console.log("alpha - "+camera.alpha);console.log("beta - "+camera.beta);console.log("radius - "+camera.radius);console.log("target - "+camera.target);};const lightHemi=new BABYLON.HemisphericLight("light1",new BABYLON.Vector3(1,1,0),scene);const lightDirect=new BABYLON.DirectionalLight("light2",new BABYLON.Vector3(0,-1,0),scene);lightHemi.intensity=0.0;lightDirect.intensity=0.0;const hdrTexture=BABYLON.CubeTexture.CreateFromPrefilteredData("studio.dds",scene);scene.environmentTexture=hdrTexture;scene.imageProcessingConfiguration.exposure=2.4;scene.imageProcessingConfiguration.toneMappingEnabled=true;scene.imageProcessingConfiguration.toneMappingType=BABYLON.ImageProcessingConfiguration.TONEMAPPING_ACES;BABYLON.SceneLoader.ShowLoadingUI=false;BABYLON.SceneLoader.Append("./","truck.glb",scene,function(newScene){loading.style.display='none';findTransparencyMaterial();findAndStoreMeshes();setupSwitches();console.log('Модель загружена и готова к работе');},null,function(error){loading.textContent='Ошибка загрузки модели: '+error.message;console.error('Ошибка загрузки:',error);});engine.runRenderLoop(function(){scene.render();});window.addEventListener('resize',function(){engine.resize();});function findTransparencyMaterial(){transparencyMaterial=scene.getMaterialByName("M_Transparency");if(transparencyMaterial){console.log('Найден прозрачный материал M_Transparency');}else{console.error('Прозрачный материал M_Transparency не найден в модели');switches.forEach(switchElem=>{switchElem.disabled=true;});}}
function findAndStoreMeshes(){meshNames.forEach(meshName=>{const mesh=scene.getMeshByName(meshName);if(mesh){meshesMap.set(meshName,{mesh:mesh,originalMaterial:mesh.material});console.log('Найден и сохранен меш:',meshName);}else{console.warn('Меш не найден:',meshName);const index=meshNames.indexOf(meshName);if(index!==-1){switches[index].disabled=true;statuses[index].textContent='Не найден';statuses[index].style.color='#ff4444';}}});}
function setupSwitches(){switches.forEach((switchElem,index)=>{switchElem.addEventListener('change',(e)=>{const makeTransparent=e.target.checked;toggleMeshTransparency(meshNames[index],makeTransparent);statuses[index].textContent=makeTransparent?'Прозрачный':'Обычный';statuses[index].style.color=makeTransparent?'#4285f4':'#666';});});}
function toggleMeshTransparency(meshName,makeTransparent){if(!transparencyMaterial)return;const meshData=meshesMap.get(meshName);if(!meshData)return;const{mesh,originalMaterial}=meshData;try{if(makeTransparent){mesh.userData=mesh.userData||{};mesh.userData.originalMaterial=mesh.material;mesh.material=transparencyMaterial;}else{mesh.material=mesh.userData?.originalMaterial||originalMaterial;}
console.log(`Меш ${meshName} ${makeTransparent ? 'сделан прозрачным' : 'восстановлен'}`);}catch(error){console.error('Ошибка при изменении материала меша:',error);}}});</script></body></html>